# 企业微信图文消息类型(news)规范

## 消息类型概述
图文消息类型用于发送带有图片和链接的富媒体消息，适合发送通知、公告、新闻等内容。

## 消息格式

### JSON 结构
```json
{
    "msgtype": "news",
    "news": {
       "articles" : [
           {
               "title" : "中秋节礼品领取",
               "description" : "今年中秋节公司有豪礼相送",
               "url" : "www.qq.com",
               "picurl" : "https://res.mail.qq.com/node/ww/wwopenmng/images/independent/doc/test_pic_msg1.png"
           }
        ]
    }
}
```

### 参数说明

| 参数 | 是否必填 | 说明 |
|------|----------|------|
| msgtype | 是 | 消息类型，此时固定为news |
| articles | 是 | 图文消息，一个图文消息支持1到8条图文 |
| title | 是 | 标题，不超过128个字节，超过会自动截断 |
| description | 否 | 描述，不超过512个字节，超过会自动截断 |
| url | 是 | 点击后跳转的链接 |
| picurl | 否 | 图文消息的图片链接，支持JPG、PNG格式，较好的效果为大图 1068*455，小图150*150 |

## 使用说明

### 基本用法
- 一个图文消息最多支持8条图文
- 每条图文都需要提供标题(title)和链接(url)
- 描述(description)和图片(picurl)为可选参数

### 图片规范
- 支持格式：JPG、PNG
- 推荐尺寸：
  - 大图：1068×455 像素
  - 小图：150×150 像素
- 图片链接必须是可访问的网络地址

### 字符限制
- 标题：最大128字节
- 描述：最大512字节
- 超出长度会自动截断

## 使用示例

### 单条图文消息
```python
# 使用 qyweixin_news 工具发送单条图文消息
await qyweixin_news(
    title="中秋节礼品领取",
    description="今年中秋节公司有豪礼相送",
    url="https://www.example.com/gift",
    picurl="https://example.com/image.jpg"
)
```

### 多条图文消息
```python
# 发送多条图文消息
articles = [
    {
        "title": "第一条新闻",
        "description": "新闻描述1",
        "url": "https://example.com/news1",
        "picurl": "https://example.com/pic1.jpg"
    },
    {
        "title": "第二条新闻",
        "description": "新闻描述2",
        "url": "https://example.com/news2",
        "picurl": "https://example.com/pic2.jpg"
    }
]

# 通过直接调用发送多条图文
await qyweixin_news(
    articles=articles
)
```

## 最佳实践

1. **标题要简洁明了**：128字节限制内表达核心信息
2. **描述要有吸引力**：512字节内说明详情，引导用户点击
3. **图片要清晰**：使用推荐尺寸，确保在不同设备上显示良好
4. **链接要有效**：确保url可以正常访问
5. **数量要适中**：虽然支持1-8条图文，但建议不超过3条以保证阅读体验

## 常见问题

### Q: 图片不显示怎么办？
A: 检查图片链接是否可访问，确保使用JPG或PNG格式，建议使用推荐尺寸。

### Q: 标题或描述被截断了？
A: 标题超过128字节或描述超过512字节会自动截断，注意中文字符通常占用2-3字节。

### Q: 可以发送几条图文消息？
A: 单次发送支持1-8条图文消息。

### Q: 图片有大小限制吗？
A: 企业微信对图片文件大小没有明确限制，但建议使用压缩后的图片以提高加载速度。

## 错误处理

- 如果标题为空，会返回错误
- 如果url为空，会返回错误
- 如果articles数组为空，会返回错误
- 如果图片链接无效，不会报错但图片不会显示

## 注意事项

1. 图文消息在企业微信中显示为卡片形式
2. 用户点击图文消息会跳转到指定的url
3. 图片建议使用CDN或稳定的图床服务
4. 链接应该是移动端友好的页面
5. 图文消息的显示效果在不同版本的企业微信中可能略有差异 